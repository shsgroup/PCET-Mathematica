(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15146,        520]
NotebookOptionsPosition[     13561,        461]
NotebookOutlinePosition[     13945,        478]
CellTagsIndexPosition[     13902,        475]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Non-orthogonal CI for two-state system", "Title",
 CellChangeTimes->{{3.656782614766631*^9, 3.656782629005381*^9}}],

Cell["\<\
Hamiltonian for a symmetric system (degenerate unperturbed states) in the \
non-orthogonal basis:\
\>", "Text",
 CellChangeTimes->{{3.656782640029291*^9, 3.6567826497249928`*^9}, {
  3.656782689197536*^9, 3.656782717108073*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"(", GridBox[{
      {"\[Alpha]", "\[Beta]"},
      {"\[Beta]", "\[Alpha]"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.65678266908727*^9, 3.656782682956094*^9}, {
  3.656782727428363*^9, 3.6567827327468348`*^9}}],

Cell[TextData[{
 "\nOverlap integral matrix S and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", 
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.656782735819764*^9, 3.6567827614375343`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"(", GridBox[{
      {"1", "\[Sigma]"},
      {"\[Sigma]", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SQ", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{"S", ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.656782766379682*^9, 3.65678277865238*^9}, {
  3.6567829871925087`*^9, 3.6567829973929443`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "@", "SQ"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6567829995523157`*^9, 3.656783003775777*^9}, {
  3.6567831707665443`*^9, 3.6567831747735357`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SqrtBox[
           RowBox[{"1", "-", "\[Sigma]"}]]], "+", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{"1", "+", "\[Sigma]"}]]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", "\[Sigma]"}]]]}], "+", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{"1", "+", "\[Sigma]"}]]]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", "\[Sigma]"}]]]}], "+", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{"1", "+", "\[Sigma]"}]]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SqrtBox[
           RowBox[{"1", "-", "\[Sigma]"}]]], "+", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{"1", "+", "\[Sigma]"}]]]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.656783004310072*^9, 3.656783175795862*^9, 
  3.656867439800799*^9}]
}, Open  ]],

Cell["\<\

Hamiltonian in the orthogonalized basis:\
\>", "Text",
 CellChangeTimes->{{3.656782790770957*^9, 3.6567828000748377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HL", "=", 
   RowBox[{"SQ", " ", ".", " ", "H", " ", ".", " ", "SQ"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.656782806052655*^9, 3.6567828226586227`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "@", "HL"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.656783016955022*^9, 3.656783035639591*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], "+", 
        RowBox[{"\[Beta]", " ", "\[Sigma]"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Sigma]", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[Beta]"}], "+", 
        RowBox[{"\[Alpha]", " ", "\[Sigma]"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Sigma]", "2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[Beta]"}], "+", 
        RowBox[{"\[Alpha]", " ", "\[Sigma]"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Sigma]", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], "+", 
        RowBox[{"\[Beta]", " ", "\[Sigma]"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Sigma]", "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.656783021235096*^9, 3.656783036724996*^9}, 
   3.656867445783533*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SQ", " ", ".", " ", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.656869999174197*^9, 3.656870011807355*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "-", "\[Sigma]"}]]}]], "+", 
    FractionBox["1", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "+", "\[Sigma]"}]]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{"1", "-", "\[Sigma]"}]]}]]}], "+", 
    FractionBox["1", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "+", "\[Sigma]"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.65687001322075*^9}]
}, Open  ]],

Cell["\<\

Eigenvectors\
\>", "Text",
 CellChangeTimes->{{3.656869912441737*^9, 3.656869917824595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvectors", "[", "HL", "]"}]], "Input",
 CellChangeTimes->{{3.65686992558976*^9, 3.656869935473734*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.656869936057126*^9}]
}, Open  ]],

Cell["\<\

Lowest eigenvalue of the Hamiltonian in the orthogonalized basis:\
\>", "Text",
 CellChangeTimes->{{3.656782872737673*^9, 3.65678289472943*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"E0", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"HL", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
       RowBox[{"HL", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HL", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
          RowBox[{"HL", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], "2"], 
       "+", 
       RowBox[{"4", 
        SuperscriptBox[
         RowBox[{"HL", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "2"]}]}]]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6567829055156603`*^9, 3.6567829723124533`*^9}, 
   3.656783545624879*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"E1", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"HL", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
       RowBox[{"HL", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HL", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
          RowBox[{"HL", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], "2"], 
       "+", 
       RowBox[{"4", 
        SuperscriptBox[
         RowBox[{"HL", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "2"]}]}]]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.656867915569085*^9, 3.6568679194322357`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"E0", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Beta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Sigma]", "\[Element]", "Reals"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.656783548441606*^9, 3.656783562607541*^9}, {
  3.656783639551804*^9, 3.6567836833203907`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[Alpha]", "-", 
    RowBox[{"\[Beta]", " ", "\[Sigma]"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}], " ", 
      RowBox[{"Abs", "[", 
       RowBox[{"\[Beta]", "-", 
        RowBox[{"\[Alpha]", " ", "\[Sigma]"}]}], "]"}]}], 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[Sigma]", "2"]}], "]"}]]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[Sigma]", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.6567835549968348`*^9, 3.656783564549633*^9}, 
   3.656783685965353*^9, 3.6568674556808863`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"E1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Beta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Sigma]", "\[Element]", "Reals"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.656867928559513*^9, 3.656867928663595*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", "\[Alpha]"}], "+", 
    RowBox[{"\[Beta]", " ", "\[Sigma]"}]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[Sigma]", "2"]}]], "+", 
  RowBox[{"Abs", "[", 
   FractionBox[
    RowBox[{"\[Beta]", "-", 
     RowBox[{"\[Alpha]", " ", "\[Sigma]"}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Sigma]", "2"]}]], "]"}]}]], "Output",
 CellChangeTimes->{3.656867931324644*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E0", ">", "\[Alpha]"}], "&&", 
    RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "&&", 
    RowBox[{
     RowBox[{"-", "1"}], "<", "\[Sigma]", "<", "1"}]}], ",", "\[Beta]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6567839132912283`*^9, 3.656784015401888*^9}, {
  3.656784089929153*^9, 3.6567841059437113`*^9}, {3.656784205950563*^9, 
  3.656784206462098*^9}, {3.6567842851183434`*^9, 3.656784399635141*^9}, {
  3.6568674670148773`*^9, 3.6568674737105703`*^9}, {3.65687185660492*^9, 
  3.6568718572434072`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.65678400267144*^9, 3.656784017166314*^9}, {
   3.656784092576882*^9, 3.6567841067429237`*^9}, 3.656784206812969*^9, {
   3.656784290478694*^9, 3.6567843116121063`*^9}, {3.6567843467826853`*^9, 
   3.656784402898369*^9}, 3.656867495107058*^9, 3.6568718607220507`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1", ">", "\[Alpha]"}], "&&", 
    RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "&&", 
    RowBox[{
     RowBox[{"-", "1"}], "<", "\[Sigma]", "<", "1"}]}], ",", "\[Beta]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.656871867331368*^9, 3.6568718677311153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "&&", 
  RowBox[{
   RowBox[{"-", "1"}], "<", "\[Sigma]", "<", "1"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Beta]", "<", 
     RowBox[{"\[Alpha]", " ", "\[Sigma]"}]}], "||", 
    RowBox[{"\[Beta]", ">", 
     RowBox[{"\[Alpha]", " ", "\[Sigma]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.656871868535798*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1289, 910},
WindowMargins->{{99, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 121, 1, 114, "Title"],
Cell[704, 25, 238, 5, 37, "Text"],
Cell[945, 32, 282, 8, 58, "Input"],
Cell[1230, 42, 258, 9, 63, "Text"],
Cell[1491, 53, 453, 14, 105, "Input"],
Cell[CellGroupData[{
Cell[1969, 71, 215, 4, 36, "Input"],
Cell[2187, 77, 1866, 61, 102, "Output"]
}, Open  ]],
Cell[4068, 141, 133, 4, 61, "Text"],
Cell[4204, 147, 194, 5, 35, "Input"],
Cell[CellGroupData[{
Cell[4423, 156, 160, 3, 36, "Input"],
Cell[4586, 161, 1537, 47, 96, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6160, 213, 173, 4, 35, "Input"],
Cell[6336, 219, 586, 22, 62, "Output"]
}, Open  ]],
Cell[6937, 244, 103, 4, 61, "Text"],
Cell[CellGroupData[{
Cell[7065, 252, 131, 2, 36, "Input"],
Cell[7199, 256, 234, 8, 35, "Output"]
}, Open  ]],
Cell[7448, 267, 155, 4, 61, "Text"],
Cell[7606, 273, 1049, 30, 59, "Input"],
Cell[8658, 305, 1021, 29, 59, "Input"],
Cell[CellGroupData[{
Cell[9704, 338, 450, 11, 36, "Input"],
Cell[10157, 351, 735, 22, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10929, 378, 399, 10, 36, "Input"],
Cell[11331, 390, 482, 16, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11850, 411, 587, 13, 35, "Input"],
Cell[12440, 426, 321, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12798, 435, 336, 9, 35, "Input"],
Cell[13137, 446, 396, 11, 35, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
